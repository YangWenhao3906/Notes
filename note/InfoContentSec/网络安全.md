### snort

#### 规则文件

##### 规则文件构成

- 定义变量`var`: 类似C语言中的宏, 在预处理直接进行替换

  ```
  var MY_NET [192.168.1.0/24, 10.1.1.0/24]
  ```

- 包含的文件`include`: 

  ```
  include <规则文件的path>
  ```

- 规则: `规则头`+`规则选项`

- 预处理: 预处理函数链

  ```
  preprocessor <name>: <options>
  ```

- output

##### 规则文件语法

https://blog.csdn.net/jiayanhui2877/article/details/40894503

举例:

```snort
 alert tcp any any -> 192.168.1.0/24 111 (content:"|00 01 86 a5|"; msg: "mountd access";)
 
alert tcp !192.168.1.0/24 any -> 192.168.1.0/24 111 (content: "|00 01 86 a5|"; msg: "external mountd access";)

log !192.168.1.0/24 any <> 192.168.1.0/24 23

```

- 规则动作

  1、Alert-使用选择的报警方法生成一个警报，然后记录（log）这个包。
  2、Log-记录这个包。
  3、Pass-丢弃（忽略）这个包。
  4、activate-报警并且激活另一条dynamic规则。
  5、dynamic-保持空闲直到被一条activate规则激活，被激活后就作为一条log规则执行

- 协议

- IP地址

- 

